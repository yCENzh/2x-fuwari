import{o as se,i as ie,I as O,b as G,r as J,h as oe,f as ce}from"./Icon.DedYlWTn.js";import{n as de,o as R,q as ue,g as b,i as fe,H as ve,u as K,v as Q,w as F,x as B,y as he,z as te,A as ae,B as pe,I as Y,C as re,D as U,E as ge,m as V,F as X,G as xe,J as me,K as be,L as _e,M as we,N as ye,O as ke,P as Ee,Q as Ce,p as Ie,l as W,a as Le,t as ne,k as Se,e as z,c as Z,d as Te,h as T,f as A,r as $,s as H,b as Ae,j}from"./render.D4aKwFGu.js";import{u as $e}from"./url-utils.uEDIkcjJ.js";/* empty css                        */function Me(d,e){return e}function Ne(d,e,t,i){for(var f=[],g=e.length,v=0;v<g;v++)be(e[v].e,f,!0);var _=g>0&&f.length===0&&t!==null;if(_){var u=t.parentNode;_e(u),u.append(t),i.clear(),M(d,e[0].prev,e[g-1].next)}we(f,()=>{for(var w=0;w<g;w++){var a=e[w];_||(i.delete(a.k),M(d,a.prev,a.next)),ye(a.e,!_)}})}function Pe(d,e,t,i,f,g=null){var v=d,_={flags:e,items:new Map,first:null};R&&ue();var u=null,w=!1,a=fe(()=>{var o=t();return xe(o)?o:o==null?[]:re(o)});de(()=>{var o=b(a),r=o.length;if(w&&r===0)return;w=r===0;let h=!1;if(R){var l=v.data===ve;l!==(r===0)&&(v=K(),Q(v),F(!1),h=!0)}if(R){for(var y=null,I,n=0;n<r;n++){if(B.nodeType===8&&B.data===he){v=B,h=!0,F(!1);break}var m=o[n],N=i(m,n);I=le(B,_,y,null,m,N,n,f,e,t),_.items.set(N,I),y=I}r>0&&Q(K())}R||Re(o,_,v,f,e,i,t),g!==null&&(r===0?u?te(u):u=ae(()=>g(v)):u!==null&&pe(u,()=>{u=null})),h&&F(!0),b(a)}),R&&(v=B)}function Re(d,e,t,i,f,g,v){var _=d.length,u=e.items,w=e.first,a=w,o,r=null,h=[],l=[],y,I,n,m;for(m=0;m<_;m+=1){if(y=d[m],I=g(y,m),n=u.get(I),n===void 0){var N=a?a.e.nodes_start:t;r=le(N,e,r,r===null?e.first:r.next,y,I,m,i,f,v),u.set(I,r),h=[],l=[],a=r.next;continue}if(qe(n,y,m),(n.e.f&Y)!==0&&te(n.e),n!==a){if(o!==void 0&&o.has(n)){if(h.length<l.length){var P=l[0],S;r=P.prev;var s=h[0],x=h[h.length-1];for(S=0;S<h.length;S+=1)ee(h[S],P,t);for(S=0;S<l.length;S+=1)o.delete(l[S]);M(e,s.prev,x.next),M(e,r,s),M(e,x,P),a=P,r=x,m-=1,h=[],l=[]}else o.delete(n),ee(n,a,t),M(e,n.prev,n.next),M(e,n,r===null?e.first:r.next),M(e,r,n),r=n;continue}for(h=[],l=[];a!==null&&a.k!==I;)(a.e.f&Y)===0&&(o??=new Set).add(a),l.push(a),a=a.next;if(a===null)continue;n=a}h.push(n),r=n,a=n.next}if(a!==null||o!==void 0){for(var p=o===void 0?[]:re(o);a!==null;)(a.e.f&Y)===0&&p.push(a),a=a.next;var c=p.length;if(c>0){var k=null;Ne(e,p,k,u)}}U.first=e.first&&e.first.e,U.last=r&&r.e}function qe(d,e,t,i){ge(d.v,e),d.i=t}function le(d,e,t,i,f,g,v,_,u,w){var a=(u&ke)!==0,o=(u&Ee)===0,r=a?o?V(f):X(f):f,h=(u&me)===0?v:X(v),l={i:h,v:r,k:g,a:null,e:null,prev:t,next:i};try{return l.e=ae(()=>_(d,r,h,w),R),l.e.prev=t&&t.e,l.e.next=i&&i.e,t===null?e.first=l:(t.next=l,t.e.next=l.e),i!==null&&(i.prev=l,i.e.prev=l.e),l}finally{}}function ee(d,e,t){for(var i=d.next?d.next.e.nodes_start:t,f=e?e.e.nodes_start:t,g=d.e.nodes_start;g!==i;){var v=Ce(g);f.before(g),g=v}}function M(d,e,t){e===null?d.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}var Be=ne(`<a class="transition first-of-type:mt-2 lg:first-of-type:mt-0 group block
       rounded-xl text-lg px-3 py-2 hover:bg-[var(--btn-plain-bg-hover)] active:bg-[var(--btn-plain-bg-active)]"><div class="transition text-90 inline-flex font-bold group-hover:text-[var(--primary)]"> <!></div> <div class="transition text-xs text-black/50 dark:text-white/50 mb-1 font-mono"> </div> <div class="transition text-sm text-50"><!></div></a>`),He=ne(`<div id="search-bar" class="hidden lg:flex transition-all items-center h-11 mr-2 rounded-lg
      bg-black/[0.04] hover:bg-black/[0.06] focus-within:bg-black/[0.06]
      dark:bg-white/5 dark:hover:bg-white/10 dark:focus-within:bg-white/10
"><!> <input placeholder="搜索" class="transition-all pl-10 text-sm bg-transparent outline-0
         h-full w-40 active:w-60 focus:w-60 text-black/50 dark:text-white/50 svelte-wkye0l"></div> <button aria-label="Search Panel" id="search-switch" class="btn-plain scale-animation lg:!hidden rounded-lg w-11 h-11 active:scale-90"><!></button> <div id="search-panel" class="float-panel float-panel-closed search-panel absolute md:w-[30rem]
top-20 left-4 md:left-[unset] right-4 shadow-2xl rounded-2xl p-2 svelte-wkye0l"><div id="search-bar-inside" class="flex relative lg:hidden transition-all items-center h-11 rounded-xl
      bg-black/[0.04] hover:bg-black/[0.06] focus-within:bg-black/[0.06]
      dark:bg-white/5 dark:hover:bg-white/10 dark:focus-within:bg-white/10
  "><!> <input placeholder="Search" class="pl-10 absolute inset-0 text-sm bg-transparent outline-0
               focus:w-60 text-black/50 dark:text-white/50 svelte-wkye0l"></div> <!></div>`,1);function Ye(d,e){Ie(e,!1);let t=V(""),i=V(""),f=V([]),g=[];const v=()=>{document.getElementById("search-panel")?.classList.toggle("float-panel-closed")},_=()=>{document.getElementById("search-panel")?.classList.add("float-panel-closed")},u=(s,x)=>{const p=document.getElementById("search-panel");!p||!x||(s?p.classList.remove("float-panel-closed"):p.classList.add("float-panel-closed"))},w=(s,x)=>{if(!x)return s;const p=new RegExp(`(${x})`,"gi");return s.replace(p,"<mark>$1</mark>")},a=async(s,x)=>{if(!s){u(!1,x),H(f,[]);return}try{const p=g.filter(c=>{const k=s.toLowerCase(),L=`${c.title} ${c.description} ${c.content}`.toLowerCase(),E=`/posts/${c.link}`;return L.includes(k)||E.toLowerCase().includes(k)||c.link.toLowerCase().includes(k)}).map(c=>{const k=c.content.toLowerCase(),L=s.toLowerCase(),E=k.indexOf(L);let C="";if(E!==-1){const q=Math.max(0,E-50),D=Math.min(c.content.length,E+100);C=c.content.substring(q,D),q>0&&(C=`...${C}`),D<c.content.length&&(C=`${C}...`)}else C=c.description||`${c.content.substring(0,150)}...`;return{url:$e(`/posts/${c.link}/`),meta:{title:c.title},excerpt:w(C,s),urlPath:`/posts/${c.link}`}});H(f,p),u(b(f).length>0,x)}catch(p){console.error("Search error:",p),H(f,[]),u(!1,x)}finally{}};se(async()=>{try{const x=await(await fetch("/rss.xml")).text(),k=new DOMParser().parseFromString(x,"text/xml").querySelectorAll("item");g=Array.from(k).map(L=>{let E="";const C=L.getElementsByTagNameNS("*","encoded")[0]?.textContent||L.querySelector("*|encoded")?.textContent||"";return C&&(E=C.replace(/<[^>]*>/g,"")),{title:L.querySelector("title")?.textContent||"",description:L.querySelector("description")?.textContent||"",content:E,link:L.querySelector("link")?.textContent?.replace(/.*\/posts\/(.*?)\//,"$1")||""}})}catch(s){console.error("Error fetching RSS:",s)}}),W(()=>b(t),()=>{a(b(t),!0)}),W(()=>b(i),()=>{a(b(i),!1)}),Le(),ie();var o=He(),r=Se(o),h=A(r);O(h,{icon:"material-symbols:search",class:"absolute text-[1.25rem] pointer-events-none ml-3 transition my-auto text-black/30 dark:text-white/30"});var l=T(h,2);J(l),$(r);var y=T(r,2),I=A(y);O(I,{icon:"material-symbols:search",class:"text-[1.25rem]"}),$(y);var n=T(y,2),m=A(n),N=A(m);O(N,{icon:"material-symbols:search",class:"absolute text-[1.25rem] pointer-events-none ml-3 transition my-auto text-black/30 dark:text-white/30"});var P=T(N,2);J(P),$(m);var S=T(m,2);Pe(S,1,()=>b(f),Me,(s,x)=>{var p=Be(),c=A(p),k=A(c,!0),L=T(k);O(L,{icon:"fa6-solid:chevron-right",class:"transition text-[0.75rem] translate-x-1 my-auto text-[var(--primary)]"}),$(c);var E=T(c,2),C=A(E,!0);$(E);var q=T(E,2),D=A(q);oe(D,()=>b(x).excerpt),$(q),$(p),Ae(()=>{ce(p,"href",b(x).url),j(k,b(x).meta.title),j(C,b(x).urlPath)}),z("click",p,_),Z(s,p)}),$(n),G(l,()=>b(t),s=>H(t,s)),z("focus",l,()=>a(b(t),!0)),z("click",y,v),G(P,()=>b(i),s=>H(i,s)),Z(d,o),Te()}export{Ye as default};
